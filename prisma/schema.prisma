datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}
generator client {
  provider = "prisma-client-js"
}

model User {
  id             Int      @id @default(autoincrement())
  loginId        String   @unique
  role           Role     @default(USER)
  adminNoteName  String?  @default("")
  loginPassword  String?  // <— добавили: видимый пароль для админки
  profile        Profile?
  codeConfig     CodeConfig?
  messagesFrom   Message[] @relation("messagesFrom")
  messagesTo     Message[] @relation("messagesTo")
}


model Profile {
  id          Int     @id @default(autoincrement())
  user        User    @relation(fields: [userId], references: [id])
  userId      Int     @unique
  websiteName String? // выбранный сайт "кокз 1" ... 
  nameOnSite  String?
  idOnSite    String?
  residence   String?
  photoUrl    String?
}

model Message {
  id        Int      @id @default(autoincrement())
  from      User     @relation("messagesSent", fields: [fromId], references: [id])
  fromId    Int
  to        User     @relation("messagesRecv", fields: [toId], references: [id])
  toId      Int
  body      String
  createdAt DateTime @default(now())
}

model CodeConfig {
  id              Int      @id @default(autoincrement())
  user            User     @relation(fields: [userId], references: [id])
  userId          Int      @unique
  code            String   @default("")
  emitIntervalSec Int      @default(22)
  paused          Boolean  @default(false)
}

enum Role {
  ADMIN
  USER
}
